{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React, { createContext, useState, useEffect, useCallback } from 'react';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { api } from \"../configs/axios\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport var UserContext = createContext({});\nexport function UserContextProvider(_ref) {\n  var children = _ref.children;\n\n  var _useState = useState(null),\n      _useState2 = _slicedToArray(_useState, 2),\n      user = _useState2[0],\n      setUser = _useState2[1];\n\n  useEffect(function () {\n    (function _callee() {\n      return _regeneratorRuntime.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (!user) {\n                _context.next = 3;\n                break;\n              }\n\n              _context.next = 3;\n              return _regeneratorRuntime.awrap(AsyncStorage.setItem('@user:social', JSON.stringify(user)));\n\n            case 3:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    })();\n  }, [user]);\n  useEffect(function () {\n    (function _callee2() {\n      var userLocal;\n      return _regeneratorRuntime.async(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return _regeneratorRuntime.awrap(AsyncStorage.getItem('@user:social'));\n\n            case 2:\n              userLocal = _context2.sent;\n\n              if (!user && userLocal) {\n                setUser(JSON.parse(userLocal));\n              }\n\n            case 4:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    })();\n  }, []);\n  var Login = useCallback(function _callee3(userProps) {\n    var _await$api$post, _data, _user, token;\n\n    return _regeneratorRuntime.async(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            _context3.prev = 0;\n            _context3.next = 3;\n            return _regeneratorRuntime.awrap(api.post('/auth/user/login', userProps));\n\n          case 3:\n            _await$api$post = _context3.sent;\n            _data = _await$api$post.data;\n            _user = _data.user, token = _data.token;\n            _context3.next = 8;\n            return _regeneratorRuntime.awrap(AsyncStorage.setItem('@token:social', token));\n\n          case 8:\n            setUser(_user);\n            _context3.next = 13;\n            break;\n\n          case 11:\n            _context3.prev = 11;\n            _context3.t0 = _context3[\"catch\"](0);\n\n          case 13:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, null, null, [[0, 11]], Promise);\n  }, []);\n  var Create = useCallback(function _callee4(userProps) {\n    var _await$api$post2, _data2, _user2, token;\n\n    return _regeneratorRuntime.async(function _callee4$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            _context4.prev = 0;\n            _context4.next = 3;\n            return _regeneratorRuntime.awrap(api.post('/auth/user/create', userProps));\n\n          case 3:\n            _await$api$post2 = _context4.sent;\n            _data2 = _await$api$post2.data;\n            _user2 = _data2.user, token = _data2.token;\n            _context4.next = 8;\n            return _regeneratorRuntime.awrap(AsyncStorage.setItem('@token:social', token));\n\n          case 8:\n            setUser(_user2);\n            _context4.next = 13;\n            break;\n\n          case 11:\n            _context4.prev = 11;\n            _context4.t0 = _context4[\"catch\"](0);\n\n          case 13:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, null, null, [[0, 11]], Promise);\n  }, []);\n  return _jsx(UserContext.Provider, {\n    value: {\n      user: user,\n      Login: Login,\n      Create: Create\n    },\n    children: children\n  });\n}","map":{"version":3,"names":["React","createContext","useState","useEffect","useCallback","AsyncStorage","api","UserContext","UserContextProvider","children","user","setUser","setItem","JSON","stringify","getItem","userLocal","parse","Login","userProps","post","data","token","Create"],"sources":["D:/social_media/mobile/src/context/UserContextProvider.tsx"],"sourcesContent":["import React, {\r\n  createContext,\r\n  useState,\r\n  useEffect,\r\n  ReactNode,\r\n  useCallback,\r\n} from 'react';\r\nimport AsyncStorage from '@react-native-async-storage/async-storage';\r\nimport { api } from '../configs/axios';\r\n\r\ninterface IUserLoginProps {\r\n  email: string;\r\n  password: string;\r\n}\r\n\r\ninterface IUserCreateProps extends IUserLoginProps {\r\n  username: string;\r\n}\r\n\r\ninterface IUserProps {\r\n  id: string;\r\n  username: string;\r\n  email: string;\r\n  createdAt: string;\r\n  updatedAt: string;\r\n}\r\n\r\ninterface IUserContextProps {\r\n  user: IUserProps | null;\r\n  Login(data: IUserLoginProps): void;\r\n  Create(data: IUserCreateProps): void;\r\n}\r\n\r\nexport const UserContext = createContext<IUserContextProps>(\r\n  {} as IUserContextProps\r\n);\r\n\r\nexport function UserContextProvider({ children }: { children: ReactNode }) {\r\n  const [user, setUser] = useState<IUserProps | null>(null);\r\n\r\n  useEffect(() => {\r\n    (async () => {\r\n      if (user) {\r\n        await AsyncStorage.setItem('@user:social', JSON.stringify(user));\r\n      }\r\n    })();\r\n  }, [user]);\r\n\r\n  useEffect(() => {\r\n    (async () => {\r\n      const userLocal = await AsyncStorage.getItem('@user:social');\r\n\r\n      if (!user && userLocal) {\r\n        setUser(JSON.parse(userLocal));\r\n      }\r\n    })();\r\n  }, []);\r\n\r\n  const Login = useCallback(async (userProps: IUserLoginProps) => {\r\n    try {\r\n      const { data } = await api.post('/auth/user/login', userProps);\r\n      const { user, token } = data;\r\n      await AsyncStorage.setItem('@token:social', token);\r\n      setUser(user);\r\n    } catch (err) {}\r\n  }, []);\r\n\r\n  const Create = useCallback(async (userProps: IUserCreateProps) => {\r\n    try {\r\n      const { data } = await api.post('/auth/user/create', userProps);\r\n      const { user, token } = data;\r\n      await AsyncStorage.setItem('@token:social', token);\r\n      setUser(user);\r\n    } catch (err) {}\r\n  }, []);\r\n\r\n  return (\r\n    <UserContext.Provider value={{ user, Login, Create }}>\r\n      {children}\r\n    </UserContext.Provider>\r\n  );\r\n}\r\n"],"mappings":";;AAAA,OAAOA,KAAP,IACEC,aADF,EAEEC,QAFF,EAGEC,SAHF,EAKEC,WALF,QAMO,OANP;AAOA,OAAOC,YAAP,MAAyB,2CAAzB;AACA,SAASC,GAAT;;AAyBA,OAAO,IAAMC,WAAW,GAAGN,aAAa,CACtC,EADsC,CAAjC;AAIP,OAAO,SAASO,mBAAT,OAAoE;EAAA,IAArCC,QAAqC,QAArCA,QAAqC;;EACzE,gBAAwBP,QAAQ,CAAoB,IAApB,CAAhC;EAAA;EAAA,IAAOQ,IAAP;EAAA,IAAaC,OAAb;;EAEAR,SAAS,CAAC,YAAM;IACd,CAAC;MAAA;QAAA;UAAA;YAAA;cAAA,KACKO,IADL;gBAAA;gBAAA;cAAA;;cAAA;cAAA,iCAESL,YAAY,CAACO,OAAb,CAAqB,cAArB,EAAqCC,IAAI,CAACC,SAAL,CAAeJ,IAAf,CAArC,CAFT;;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IAAA,CAAD;EAKD,CANQ,EAMN,CAACA,IAAD,CANM,CAAT;EAQAP,SAAS,CAAC,YAAM;IACd,CAAC;MAAA;MAAA;QAAA;UAAA;YAAA;cAAA;cAAA,iCACyBE,YAAY,CAACU,OAAb,CAAqB,cAArB,CADzB;;YAAA;cACOC,SADP;;cAGC,IAAI,CAACN,IAAD,IAASM,SAAb,EAAwB;gBACtBL,OAAO,CAACE,IAAI,CAACI,KAAL,CAAWD,SAAX,CAAD,CAAP;cACD;;YALF;YAAA;cAAA;UAAA;QAAA;MAAA;IAAA,CAAD;EAOD,CARQ,EAQN,EARM,CAAT;EAUA,IAAME,KAAK,GAAGd,WAAW,CAAC,kBAAOe,SAAP;IAAA;;IAAA;MAAA;QAAA;UAAA;YAAA;YAAA;YAAA,iCAECb,GAAG,CAACc,IAAJ,CAAS,kBAAT,EAA6BD,SAA7B,CAFD;;UAAA;YAAA;YAEdE,KAFc,mBAEdA,IAFc;YAGdX,KAHc,GAGEW,KAHF,CAGdX,IAHc,EAGRY,KAHQ,GAGED,KAHF,CAGRC,KAHQ;YAAA;YAAA,iCAIhBjB,YAAY,CAACO,OAAb,CAAqB,eAArB,EAAsCU,KAAtC,CAJgB;;UAAA;YAKtBX,OAAO,CAACD,KAAD,CAAP;YALsB;YAAA;;UAAA;YAAA;YAAA;;UAAA;UAAA;YAAA;QAAA;MAAA;IAAA;EAAA,CAAD,EAOtB,EAPsB,CAAzB;EASA,IAAMa,MAAM,GAAGnB,WAAW,CAAC,kBAAOe,SAAP;IAAA;;IAAA;MAAA;QAAA;UAAA;YAAA;YAAA;YAAA,iCAEAb,GAAG,CAACc,IAAJ,CAAS,mBAAT,EAA8BD,SAA9B,CAFA;;UAAA;YAAA;YAEfE,MAFe,oBAEfA,IAFe;YAGfX,MAHe,GAGCW,MAHD,CAGfX,IAHe,EAGTY,KAHS,GAGCD,MAHD,CAGTC,KAHS;YAAA;YAAA,iCAIjBjB,YAAY,CAACO,OAAb,CAAqB,eAArB,EAAsCU,KAAtC,CAJiB;;UAAA;YAKvBX,OAAO,CAACD,MAAD,CAAP;YALuB;YAAA;;UAAA;YAAA;YAAA;;UAAA;UAAA;YAAA;QAAA;MAAA;IAAA;EAAA,CAAD,EAOvB,EAPuB,CAA1B;EASA,OACE,KAAC,WAAD,CAAa,QAAb;IAAsB,KAAK,EAAE;MAAEA,IAAI,EAAJA,IAAF;MAAQQ,KAAK,EAALA,KAAR;MAAeK,MAAM,EAANA;IAAf,CAA7B;IAAA,UACGd;EADH,EADF;AAKD"},"metadata":{},"sourceType":"module"}